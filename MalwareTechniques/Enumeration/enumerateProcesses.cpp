// list all running processes
#include <Windows.h>
#include <TlHelp32.h>
#include <stdio.h>

int main(int argc, char* argv[]) {
	HANDLE hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
	if (hSnapshot == INVALID_HANDLE_VALUE) return 0;

	PROCESSENTRY32 pEntry;
	pEntry.dwSize = sizeof(PROCESSENTRY32);

	if (Process32First(hSnapshot, &pEntry)) {
		do {
			printf("PID: %-6d Process Name: %ls\n", pEntry.th32ProcessID, pEntry.szExeFile);
		} while (Process32Next(hSnapshot, &pEntry));

	}
	CloseHandle(hSnapshot);
	return 0;
}