import "pe"

rule selfInjection
{
    meta:
        author = "labieno"
	description = "Detect PE file & code injection API functions"
    condition:
        pe.is_pe and
        pe.imports("kernel32.dll", "VirtualAllocEx") and
	pe.imports("kernel32.dll", "WriteProcessMemory") and
	pe.imports("kernel32.dll", "CreateRemoteThread")
}