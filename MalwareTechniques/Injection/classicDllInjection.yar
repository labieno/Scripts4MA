import "pe"

rule selfInjection
{
    meta:
        author = "labieno"
	description = "Detect PE file & DLL injection API functions"
    strings:
	$loadlibrary = "LoadLibraryA" wide ascii
    condition:
        pe.is_pe and
        pe.imports("kernel32.dll", "GetProcAddress") and
	pe.imports("kernel32.dll", "WriteProcessMemory") and
	$loadlibrary
}